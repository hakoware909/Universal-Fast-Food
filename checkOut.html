<!DOCTYPE html>
<html lang="en">
<head>

    <link rel="shortcun icon" type="x-icon" href="images/logo1.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>


<style>
body{
    font-family: monospace;
    overflow-x: hidden;
    font-synthesis: 15px;
}
a{
    text-decoration: none;
}
.container{
    width: 1200px;
    margin: auto;
    max-width: 90%;
    transition: transform 1s;
}

.checkoutLayout{
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 50px;
    padding: 20px;
}
.checkoutLayout .right{
    background-color: #5358B3;
    border-radius: 20px;
    padding: 40px;
    color: #fff;
}
.checkoutLayout .right .form{
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    border-bottom: 1px solid #7a7fe2;
    padding-bottom: 20px;
}
.checkoutLayout .form h1,
.checkoutLayout .form .group:nth-child(-n+3){
    grid-column-start: 1;
    grid-column-end: 3;
}
.checkoutLayout .form input, 
.checkoutLayout .form select
{
    width: 100%;
    padding: 10px 20px;
    box-sizing: border-box;
    border-radius: 20px;
    margin-top: 10px;
    border:none;
    background-color: #6a6fc9;
    color: #fff;
}
.checkoutLayout .right .return .row{
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
}
.checkoutLayout .right .return .row div:nth-child(2){
    font-weight: bold;
    font-size: x-large;
}
.buttonCheckout{
    width: 100%;
    height: 40px;
    border: none;
    border-radius: 20px;
    background-color: #49D8B9;
    margin-top: 20px;
    font-weight: bold;
    color: #fff;
    cursor: pointer;
}
.buttonCheckout:hover{
    opacity: 0.8;
}
.returnCart h1{
    border-top: 1px solid #eee;  
    padding: 20px 0;
}
.returnCart .list .item img{
    height: 80px;
}
.returnCart .list .item{
    display: grid;
    grid-template-columns: 125px 1fr  50px 80px;
    align-items: center;
    gap: 20px;
    margin-bottom: 30px;
    box-shadow: 0 10px 20px #5555;
    border-radius: 20px;
}
.returnCart .list .item .name,
.returnCart .list .item .returnPrice{
    font-size: large;
    font-weight: bold;
}
.container1{
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}
.popup{
  width: 400px;
  background: #fff;
  border-radius: 6px;
  position: absolute;
  top: 0%;
  left: 50%;
  transform: translate(-50%, -50%)scale(0.1);
  text-align: center;
  padding: 0 30px 30px;
  color: #333;
  visibility: hidden;
  transition: transform 0.4s, top 0.4s;
}
.open-popup{
  visibility: visible;
  top: 50%;
  transform: translate(-50%, -50%)scale(1);
}

.popup img{
  width: 100px;
  margin-top: -50px;
  border-radius: 50%;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}
.popup h2{
  font-size: 38px;
  font-weight: 500;
  margin: 30px 0 10px;
}
.pop p{
  font-size: 10px;
}
.popup button{
  width: 100%;
  margin-top: 50px;
  padding: 10px 0;
  background: #6fd649;
  color: #fff;
  border: 0;
  outline: none;
  font-size: 18px;
  border-radius: 4px;
  cursor: pointer;
  box-shadow: 0 5px 5px rgba(0, 0, 0, 0.2);

}

</style>
</head>
<body>
    
<div class="container">
    <div class="checkoutLayout">

        
        <div class="returnCart">
            <a href="/order.html">keep shopping</a>
            <h1>List Product in Cart</h1>
            <div class="list">

                <div class="item">
                    <img src="images/order/1.png">
                    <div class="info">
                        <div class="name">Chowking Pork Chowfan</div>
                        <div class="price">â‚±179/1 product</div>
                    </div>
                    <div class="quantity">3</div>
                    <div class="returnPrice">433.3</div>
                </div>

            </div>
        </div>


        <div class="right">
            <h1>Checkout</h1>

            <div class="form">
                <div class="group">
                    <label for="name">Full Name</label>
                    <input type="text" name="name" id="name" required>
                </div>
    
                <div class="group">
                    <label for="phone">Phone Number</label>
                    <input type="number" name="phone" id="phone" required>
                </div>
    
                <div class="group">
                    <label for="address">Address</label>
                    <input type="text" name="address" id="address" required>
                </div>
    
                <div class="group">
                    <label for="payment">Payment</label>
                    <select name="payment" id="payment" required>
                        <option value="">Choose..</option>
                        <option value="COD">Cash on Delivery</option>
                        <option value="COPU">Cash on Pick Up</option>
                        <option value="GCASH">GCASH</option>

                    </select>
                </div>
    
                <div class="group">
                    <label for="Card">If Card for Payment</label>
                    <select name="card" id="card" required>
                        <option value="">Choose..</option>
                        <option value="Metrobank">Metrobank</option>
                        <option value="ChinaBank">ChinaBank</option>
                    </select>
                </div>
            </div>
            <div class="return">
                <div class="row">
                    <div>Total Quantity</div>
                    <div class="totalQuantity">70</div>
                </div>
                <div class="row">
                    <div>Total Price</div>
                    <div class="totalPrice">$900</div>
                </div>
            </div>
            <button class="buttonCheckout" action="delivery.html" onclick="validateForm() && openPopup(event)">CHECKOUT</button>
                <div class="popup" id="popup">
                    <img src="images/tick.png">
                <h2>Please Wait</h2>
                <h1>Your order is being processed, please wait till the delivery rider calls your number. Thank you!</h1>
                <button type="button" onclick="closePopup()">OK</button>
            </div>
    </div>
</div>



<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Retrieve checkout data from sessionStorage
        const checkoutData = JSON.parse(sessionStorage.getItem('checkoutData'));

        // Display checkout data in the receipt
        document.getElementById("customerName").innerText = checkoutData.name;
        document.getElementById("customerPhone").innerText = checkoutData.phone;
        document.getElementById("customerAddress").innerText = checkoutData.address;
        document.getElementById("paymentMethod").innerText = checkoutData.payment;
        document.getElementById("cardType").innerText = checkoutData.card;

        // You can update other parts of the receipt similarly with the retrieved data.
    });

    function openPopup(event) {
        event.preventDefault();
        const checkoutData = {
            name: document.getElementById("name").value,
            phone: document.getElementById("phone").value,
            address: document.getElementById("address").value,
            payment: document.getElementById("payment").value,
            card: document.getElementById("card").value,
            // Add other relevant data as needed
        };

        // Save checkout data to sessionStorage
        sessionStorage.setItem('checkoutData', JSON.stringify(checkoutData));

        // Open the processing popup
        popup.classList.add("open-popup");

        // Use setTimeout to simulate the processing time
        setTimeout(() => {
            // Redirect to delivery.html after processing
            window.location.href = "delivery.html";

            // Open a new tab with receipt.html
            const receiptWindow = window.open("receipt.html", "_blank");
            if (receiptWindow) {
                // Optionally, you can focus the new tab
                receiptWindow.focus();
            } else {
                console.error("Failed to open the receipt window.");
            }
        }, 3000); // Adjust the time delay as needed
    }




function clearCart() {
    // Clear cart data in sessionStorage
    sessionStorage.removeItem('cartData');

    // Clear cart data in cookies if needed
    document.cookie = "listCart=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/";
}


function addToCart(product) {
    // ... (existing code)
    // Add product to the cartData array
    cartData.push(product);
    // Save the updated cartData to sessionStorage
    sessionStorage.setItem('cartData', JSON.stringify(cartData));
    // Save the updated cartData to cookies if needed
    document.cookie = `listCart=${JSON.stringify(cartData)};path=/;max-age=${60 * 60 * 24 * 7}`;
}
function closePopup() {
    popup.classList.remove("open-popup");
}

let listCart = [];
function checkCart(){
        var cookieValue = document.cookie
        .split('; ')
        .find(row => row.startsWith('listCart='));
        if(cookieValue){
            listCart = JSON.parse(cookieValue.split('=')[1]);
        }
}
checkCart();
addCartToHTML();
function addCartToHTML(){
    // clear data default
    let listCartHTML = document.querySelector('.returnCart .list');
    listCartHTML.innerHTML = '';

    let totalQuantityHTML = document.querySelector('.totalQuantity');
    let totalPriceHTML = document.querySelector('.totalPrice');
    let totalQuantity = 0;
    let totalPrice = 0;
    // if has product in Cart
    if(listCart){
        listCart.forEach(product => {
            if(product){
                let newCart = document.createElement('div');
                newCart.classList.add('item');
                newCart.innerHTML = 
                    `<img src="${product.image}">
                    <div class="info">
                        <div class="name">${product.name}</div>
                        <div class="price">${typeof product.price === 'number' ? 'â‚±' + product.price.toFixed(2) : product.price}/1 product</div>
                    </div>
                    <div class="quantity">${product.quantity}</div>
                    <div class="returnPrice">${typeof product.price === 'number' ? 'â‚±' + product.price.toFixed(2) : product.price}</div>`;
                listCartHTML.appendChild(newCart);
                totalQuantity = totalQuantity + product.quantity;
                totalPrice = totalPrice + (product.price * product.quantity);
            }
        });
    }
    totalQuantityHTML.innerText = totalQuantity;
    totalPriceHTML.innerText = `â‚±${totalPrice.toFixed(2)}`;
}

    addCartToHTML();

const exampleProduct = {
    name: 'Example Product',
    price: 25,
    image: 'images/example.webp',
    quantity: 2
};

checkCart();
addToCart(exampleProduct);


function validateForm() {
  var name = document.getElementById("name").value;
  var phone = document.getElementById("phone").value;
  var address = document.getElementById("address").value;
  var payment = document.getElementById("payment").value;

  if (name === "" || phone === "" || address === "" || payment === "") {
    alert("Please fill out all required fields before checking out.");
    return false;

  }

  return true;
}

</script>

</body>
</html>